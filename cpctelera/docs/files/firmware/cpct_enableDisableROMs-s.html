<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Enabling / disabling ROMs - . .</title><link rel="stylesheet" type="text/css" href="../../styles/main.css"><script language=JavaScript src="../../javascript/main.js"></script><script language=JavaScript src="../../javascript/prettify.js"></script><script language=JavaScript src="../../javascript/searchdata.js"></script></head><body class="ContentPage" onLoad="NDOnLoad();prettyPrint();"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version 1.52 -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->




<div id=Content><div class="CSection"><div class=CTopic id=MainTopic><h1 class=CTitle><a name="Enabling/disabling_ROMs"></a>Enabling / disabling ROMs</h1><div class=CBody><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SMain"><td class=SEntry><a href="#Enabling/disabling_ROMs" >Enabling / disabling ROMs</a></td><td class=SDescription></td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#Enabling/disabling_ROMs" >Enabling / disabling ROMs</a></td><td class=SDescription>This 4 functions enable / disable lower or upper ROMs.</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#cpct_enableUpperROM" >cpct_enableUpperROM</a></td><td class=SDescription>Enables Upper ROM  [0xC000 - 0xFFFF]</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#cpct_enableLowerROM" >cpct_enableLowerROM</a></td><td class=SDescription>Enables Lower ROM  [0x0000 - 0x3FFF]</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#cpct_disableUpperROM" >cpct_disableUpperROM</a></td><td class=SDescription>Disables upper ROM [0xC000 - 0xFFFF]</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#cpct_disableLowerROM" >cpct_disableLowerROM</a></td><td class=SDescription>Disables Lower ROM [0x0000 - 0x3FFF]</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#Lower_ROM" >Lower ROM</a></td><td class=SDescription>[ 0x0000 - 0x3FFF ]</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#Upper_ROM" >Upper ROM</a></td><td class=SDescription>[ 0xC000 - 0xFFFF ]</td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="Enabling/disabling_ROMs"></a>Enabling / disabling ROMs</h3><div class=CBody><p>This 4 functions enable / disable lower or upper ROMs.</p><h4 class=CHeading>C Definitions</h4><p>void <a href="#cpct_enableUpperROM" class=LFunction id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">cpct_enableUpperROM</a> ()</p><p>void <a href="#cpct_enableLowerROM" class=LFunction id=link2 onMouseOver="ShowTip(event, 'tt2', 'link2')" onMouseOut="HideTip('tt2')">cpct_enableLowerROM</a> ()</p><p>void <a href="#cpct_disableUpperROM" class=LFunction id=link3 onMouseOver="ShowTip(event, 'tt3', 'link3')" onMouseOut="HideTip('tt3')">cpct_disableUpperROM</a> ()</p><p>void <a href="#cpct_enableUpperROM" class=LFunction id=link4 onMouseOver="ShowTip(event, 'tt1', 'link4')" onMouseOut="HideTip('tt1')">cpct_enableUpperROM</a> ()</p><h4 class=CHeading>Assembly calls</h4><blockquote><pre>call cpct_enableUpperROM_asm
call cpct_enableLowerROM_asm
call cpct_disableUpperROM_asm
call cpct_enableUpperROM_asm</pre></blockquote><h4 class=CHeading>Known limitations</h4><ul><li>If the execution of your program is going through some of these 2 ROM spaces and you enable ROM, CPU will be unable to get machine code of your program, as it will start reading from ROM instead of RAM (where your program is placed).&nbsp; This will result in unexpected behaviour.</li><li>Enabling Lower ROM re-enables Firmware JMP in interrupt mode 1, as it re-establishes the values at memory location 0x0038.&nbsp; If you have disabled the firmware by putting FB:C9 (EI:RET) at 0x0038 (as <a href="cpct_disableFirmware-s.html#cpct_disableFirmware" class=LFunction id=link5 onMouseOver="ShowTip(event, 'tt4', 'link5')" onMouseOut="HideTip('tt4')">cpct_disableFirmware</a> does) you may experience undesired behaviour when next interrupts come.&nbsp; The most typical is a return to MODE 1, as firmware may be unaware of your currently selected MODE and will try to re-establish its own MODE.&nbsp; Take it into account and disable interrupts if you need.</li></ul><h4 class=CHeading>Details</h4><p>These 4 functions enable / disable lower or upper ROMs.&nbsp; By default, <b>CPCtelera</b> sets both ROMS as disabled at the first event of video mode change.&nbsp; Enabling one of them means changing the way the CPU gets information from memory: on the places where ROM is enabled, CPU gets values from ROM whenever it tries to read from memory.</p><p>If ROM is disabled, these memory reads get values from RAM.&nbsp; ROMs are mapped in this address space:</p><p>CPU Requests to write to memory are always mapped to RAM, so there is no need to worry about that.&nbsp; Also, Gate Array always gets video memory values from RAM (it never reads from ROM), so enabling Upper ROM does not have any impact on the screen.</p><h4 class=CHeading>Destroyed Register values</h4><p>AF, BC, HL</p><h4 class=CHeading>Required memory</h4><p>122 bytes</p><h4 class=CHeading>Time Measures</h4><blockquote><pre class="prettyprint">Case  | Cycles | microSecs (us)
-------------------------------
Best  |   86   |   21.50
-------------------------------
Worst |   96   |   24.00
-------------------------------</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="cpct_enableUpperROM"></a>cpct_enableUpperROM</h3><div class=CBody><p>Enables Upper ROM  [0xC000 - 0xFFFF]</p></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="cpct_enableLowerROM"></a>cpct_enableLowerROM</h3><div class=CBody><p>Enables Lower ROM  [0x0000 - 0x3FFF]</p></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="cpct_disableUpperROM"></a>cpct_disableUpperROM</h3><div class=CBody><p>Disables upper ROM [0xC000 - 0xFFFF]</p></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="cpct_disableLowerROM"></a>cpct_disableLowerROM</h3><div class=CBody><p>Disables Lower ROM [0x0000 - 0x3FFF]</p></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="Lower_ROM"></a>Lower ROM</h3><div class=CBody><p>[ 0x0000 - 0x3FFF ]</p></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="Upper_ROM"></a>Upper ROM</h3><div class=CBody><p>[ 0xC000 - 0xFFFF ]</p></div></div></div>

</div><!--Content-->


<div id=Footer>&copy;opyright 2015 CPCtelera authors. Distributed under GNU GPL License.&nbsp; &middot;&nbsp; Last updated 2015/05/11&nbsp; &middot;&nbsp; <a href="http://www.naturaldocs.org">Generated by Natural Docs</a></div><!--Footer-->


<div id=Menu><div class=MTitle>. .<div class=MSubTitle></div></div><div class=MEntry><div class=MLink><a href="https://github.com/lronaldo/cpctelera">CPCtelera at Github</a></div></div><div class=MEntry><div class=MFile><a href="../readme-txt.html">CPCtelera Reference Manual</a></div></div><div class=MEntry><div class=MFile><a href="../authors-txt.html">Authors</a></div></div><div class=MEntry><div class=MFile><a href="../license-txt.html">License</a></div></div><div class=MEntry><div class=MText>______________________________________________________________________</div></div><div class=MEntry><div class=MFile><a href="../types-h.html">Aliases for builtin types</a></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent1')">Audio</a><div class=MGroupContent id=MGroupContent1><div class=MEntry><div class=MFile><a href="../audio/arkostracker-s.html">Arkos Player Functions</a></div></div><div class=MEntry><div class=MFile><a href="../audio/arkosplayer-txt.html">Arkos Player Manual</a></div></div><div class=MEntry><div class=MFile><a href="../audio/audio-h.html">Audio Constants&amp;Variables</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_musicPlay">cpct_akp_musicPlay</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_musicInit">cpct_akp_musicInit</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_stop">cpct_akp_stop</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_SFXGetInstrument">cpct_akp_SFXGetInstrument</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_SFXInit">cpct_akp_SFXInit</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_SFXStopAll">cpct_akp_SFXStopAll</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_SFXPlay">cpct_akp_SFXPlay</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_stop">cpct_akp_SFXStop</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_setFadeVolume">cpct_akp_setFadeVolume</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent2')">Bitarray</a><div class=MGroupContent id=MGroupContent2><div class=MEntry><div class=MFile><a href="../bitarray/cpct_get2Bits-s.html">cpct_get2Bits</a></div></div><div class=MEntry><div class=MFile><a href="../bitarray/cpct_get4Bits-s.html">cpct_get4Bits</a></div></div><div class=MEntry><div class=MFile><a href="../bitarray/cpct_getBit-s.html">cpct_getBit</a></div></div><div class=MEntry><div class=MFile><a href="../bitarray/cpct_set2Bits-s.html">cpct_set2Bits</a></div></div><div class=MEntry><div class=MFile><a href="../bitarray/cpct_set4Bits-s.html">cpct_set4Bits</a></div></div><div class=MEntry><div class=MFile><a href="../bitarray/cpct_setBit-s.html">cpct_setBit</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent3')">Firmware</a><div class=MGroupContent id=MGroupContent3><div class=MEntry><div class=MFile><a href="cpct_disableFirmware-s.html">cpct_disableFirmware</a></div></div><div class=MEntry><div class=MFile><a href="cpct_reenableFirmware-s.html">cpct_reenableFirmware</a></div></div><div class=MEntry><div class=MFile id=MSelected>Enabling / disabling ROMs</div></div><div class=MEntry><div class=MFile><a href="firmware-s.html">Firmware&amp;ROM variables</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent4')">Keyboard</a><div class=MGroupContent id=MGroupContent4><div class=MEntry><div class=MFile><a href="../keyboard/cpct_isKeyPressed-s.html">cpct_isKeyPressed</a></div></div><div class=MEntry><div class=MFile><a href="../keyboard/cpct_isKeyPressed_asm-s.html">cpct_isKeyPressed_asm</a></div></div><div class=MEntry><div class=MFile><a href="../keyboard/cpct_scanKeyboard-s.html">cpct_scanKeyboard</a></div></div><div class=MEntry><div class=MFile><a href="../keyboard/cpct_scanKeyboard_f-s.html">cpct_scanKeyboard_f</a></div></div><div class=MEntry><div class=MFile><a href="../keyboard/keyboard-h.html">Keyboard Mappings&amp;Constants</a></div></div><div class=MEntry><div class=MFile><a href="../keyboard/keyboard-txt.html">Keyboard Technicals</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent5')">Sprites</a><div class=MGroupContent id=MGroupContent5><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawSolidBox-s.html">cpct_drawSolidBox</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawSprite-s.html">cpct_drawSprite</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawSpriteMasked-s.html">cpct_drawSpriteMasked</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawTileAligned2x8-s.html">cpct_drawTileAligned2x8</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawTileAligned2x8_f-s.html">cpct_drawTileAligned2x8_f</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawTileAligned4x8-s.html">cpct_drawTileAligned4x8</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawTileAligned4x8_f-s.html">cpct_drawTileAligned4x8_f</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_px2byteM0-s.html">cpct_px2byteM0</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_px2byteM1-s.html">cpct_px2byteM1</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/sprites-h.html">Sprite Macros&amp;Constants</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent6')">Strings</a><div class=MGroupContent id=MGroupContent6><div class=MEntry><div class=MFile><a href="../strings/cpct_drawCharM0-s.html">cpct_drawCharM0</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawCharM1-s.html">cpct_drawCharM1</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawCharM1_f-s.html">cpct_drawCharM1_f</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawCharM2-s.html">cpct_drawCharM2</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawStringM0-s.html">cpct_drawStringM0</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawStringM1-s.html">cpct_drawStringM1</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawStringM1_f-s.html">cpct_drawStringM1_f</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawStringM2-s.html">cpct_drawStringM2</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_putChar-s.html">putchar</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent7')">Video</a><div class=MGroupContent id=MGroupContent7><div class=MEntry><div class=MFile><a href="../video/cpct_count2VSYNC-s.html">cpct_count2VSYNC</a></div></div><div class=MEntry><div class=MFile><a href="../video/cpct_firmware2hw_colour_table-s.html">cpct_firmware2hw_colour</a></div></div><div class=MEntry><div class=MFile><a href="../video/cpct_fw2hw-s.html">cpct_fw2hw</a></div></div><div class=MEntry><div class=MFile><a href="../video/cpct_getHWColor-s.html">cpct_getHWColour</a></div></div><div class=MEntry><div class=MFile><a href="../video/cpct_getScreenPtr-s.html">cpct_getScreenPtr</a></div></div><div class=MEntry><div class=MFile><a href="../video/cpct_setPALColour-s.html">cpct_setPALColour</a></div></div><div class=MEntry><div class=MFile><a href="../video/cpct_setPalette-s.html">cpct_setPalette</a></div></div><div class=MEntry><div class=MFile><a href="../video/cpct_setVideoMemoryOffset-s.html">cpct_setVideoMemoryOffset</a></div></div><div class=MEntry><div class=MFile><a href="../video/cpct_setVideoMemoryPage-s.html">cpct_setVideoMemoryPage</a></div></div><div class=MEntry><div class=MFile><a href="../video/cpct_setVideoMode-s.html">cpct_setVideoMode</a></div></div><div class=MEntry><div class=MFile><a href="../video/cpct_waitVSYNC-s.html">cpct_waitVSYNC</a></div></div><div class=MEntry><div class=MFile><a href="../video/videomode-h.html">Video Macros&amp;Constants</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent8')">Memutils</a><div class=MGroupContent id=MGroupContent8><div class=MEntry><div class=MFile><a href="../memutils/cpct_memcpy-s.html">cpct_memcpy</a></div></div><div class=MEntry><div class=MFile><a href="../memutils/cpct_memset-s.html">cpct_memset</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent9')">Command Line Tools</a><div class=MGroupContent id=MGroupContent9><div class=MEntry><div class=MFile><a href="../commandline/cpct_bin2c-.html">cpct_bin2c</a></div></div><div class=MEntry><div class=MFile><a href="../commandline/cpct_mkproject-.html">cpct_mkproject</a></div></div><div class=MEntry><div class=MFile><a href="../commandline/cpct_rgas2c-.html">cpct_rgas2c</a></div></div><div class=MEntry><div class=MFile><a href="../commandline/cpct_sp2tiles-.html">cpct_sp2tiles</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent10')">Index</a><div class=MGroupContent id=MGroupContent10><div class=MEntry><div class=MIndex><a href="../../index/Constants.html">Constants</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/General.html">Everything</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/Files.html">Files</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/Functions.html">Functions</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/Macros.html">Macros</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/Types.html">Types</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/Variables.html">Variables</a></div></div></div></div></div><script type="text/javascript"><!--
var searchPanel = new SearchPanel("searchPanel", "HTML", "../../search");
--></script><div id=MSearchPanel class=MSearchPanelInactive><input type=text id=MSearchField value=Search onFocus="searchPanel.OnSearchFieldFocus(true)" onBlur="searchPanel.OnSearchFieldFocus(false)" onKeyUp="searchPanel.OnSearchFieldChange()"><select id=MSearchType onFocus="searchPanel.OnSearchTypeFocus(true)" onBlur="searchPanel.OnSearchTypeFocus(false)" onChange="searchPanel.OnSearchTypeChange()"><option  id=MSearchEverything selected value="General">Everything</option><option value="Constants">Constants</option><option value="Files">Files</option><option value="Functions">Functions</option><option value="Macros">Macros</option><option value="Types">Types</option><option value="Variables">Variables</option></select></div><script language=JavaScript><!--
HideAllBut([3], 11);// --></script></div><!--Menu-->



<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CFunction>Enables Upper ROM  [0xC000 - 0xFFFF]</div></div><div class=CToolTip id="tt2"><div class=CFunction>Enables Lower ROM  [0x0000 - 0x3FFF]</div></div><div class=CToolTip id="tt3"><div class=CFunction>Disables upper ROM [0xC000 - 0xFFFF]</div></div><div class=CToolTip id="tt4"><div class=CFunction>Disables Amstrad CPC firmware, preventing it from being executed at every CPU interrupt.</div></div><!--END_ND_TOOLTIPS-->




<div id=MSearchResultsWindow><iframe src="" frameborder=0 name=MSearchResults id=MSearchResults></iframe><a href="javascript:searchPanel.CloseResultsWindow()" id=MSearchResultsWindowClose>Close</a></div>


<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>