<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN" "http://www.w3.org/TR/REC-html40/strict.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>cpct_setPalette - CPCtelera</title><link rel="stylesheet" type="text/css" href="../../styles/main.css"><script language=JavaScript src="../../javascript/main.js"></script><script language=JavaScript src="../../javascript/prettify.js"></script><script language=JavaScript src="../../javascript/searchdata.js"></script></head><body class="ContentPage" onLoad="NDOnLoad();prettyPrint();"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version 1.52 -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->




<div id=Content><div class="CFunction"><div class=CTopic id=MainTopic><h1 class=CTitle><a name="cpct_setPalette"></a>cpct_setPalette</h1><div class=CBody><p>Changes the hardware palette colour values (selecting new ones).</p><h4 class=CHeading>C Definition</h4><p>void <a href="#cpct_setPalette" class=LFunction id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">cpct_setPalette</a> (<a href="../types-h.html#u8" class=LType id=link2 onMouseOver="ShowTip(event, 'tt2', 'link2')" onMouseOut="HideTip('tt2')">u8</a>* <b>colour_array</b>, <a href="../types-h.html#u8" class=LType id=link3 onMouseOver="ShowTip(event, 'tt2', 'link3')" onMouseOut="HideTip('tt2')">u8</a> <b>size</b>)</p><h4 class=CHeading>Input Parameters (3 Bytes)</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>(2B DE) colour_array</td><td class=CDLDescription>Pointer to a byte array containing new hardware colour values [0 - 31]</td></tr><tr><td class=CDLEntry>(1B A ) size</td><td class=CDLDescription>[1 - 16] Number of colours to change</td></tr></table><h4 class=CHeading>Assembly call (Input parameters on registers)</h4><blockquote><pre>call cpct_setPalette_asm</pre></blockquote><h4 class=CHeading>Parameter Restrictions</h4><ul><li><b>colour_array</b> must be an array of unsigned 8-bit values (u8), each one in the [0-31] range.</li><li><b>size</b> must be between 1 and 16.&nbsp; A size of 0 will be treated as 16, and any value greater than 16 will be modularized into [1-16] range (using only least significant 4 bits)</li></ul><h4 class=CHeading>Requirements</h4><p>This function requires the CPC <b>firmware</b> to be <b>DISABLED</b>.&nbsp; Otherwise, it may not work, as firmware tends to restore palette colour values to its own selection.</p><h4 class=CHeading>Details</h4><p>This function modifies hardware palette registers to set new colours to use.&nbsp; These colours values are easily identified with PENs on the CPC, and are the ones shown in the 2nd column of Table 1.&nbsp; The function starts modiying PEN 0, and goes changing PEN 1, 2, 3... up to the number of provided colours (<b>size</b>) from the <b>colour_array</b>.&nbsp; It is important to notice that this function requires hardware colour values, which are different from firmware colour values (usually known as INKs on the CPC).&nbsp; Table 1 shows all of them, and you may use it for reference.</p><p>Palette registers are contained inside the PAL chip of the CPC (which is located inside the Gate Array).&nbsp; To access PAL chip, the same port (&amp;7F) as Gate Array is used.&nbsp; The function is not thought to be optimal, but secure.&nbsp; If a more optimal one is required, it can be derived from this code.&nbsp; The array of color values passed to this routine must include hardware color values (0-31) and not firmware ones.</p><blockquote><pre class="prettyprint">Firmware | Hardware  | Hard+Command | Colour Name    |  R%   G%   B% Colour
---------------------------------------------------------------------------
     0   | 20 (0x14) |  0x54        | Black          |   0    0    0
     1   |  4 (0x04) |  0x44 (0x50) | Blue           |   0    0   50
     2   | 21 (0x15) |  0x55        | Bright Blue    |   0    0  100
     3   | 28 (0x1C) |  0x5C        | Red            |  50    0    0
     4   | 24 (0x18) |  0x58        | Magenta        |  50    0   50
     5   | 29 (0x1D) |  0x5D        | Mauve          |  50    0  100
     6   | 12 (0x0C) |  0x4C        | Bright Red     | 100    0    0
     7   |  5 (0x05) |  0x45 (0x48) | Purple         | 100    0   50
     8   | 13 (0x0D) |  0x4D        | Bright Magenta | 100    0  100
     9   | 22 (0x16) |  0x56        | Green          |   0   50    0
    10   |  6 (0x06) |  0x46        | Cyan           |   0   50   50
    11   | 23 (0x17) |  0x57        | Sky Blue       |   0   50  100
    12   | 30 (0x1E) |  0x5E        | Yellow         |  50   50    0
    13   |  0 (0x00) |  0x40 (0x41) | White          |  50   50   50
    14   | 31 (0x1F) |  0x5F        | Pastel Blue    |  50   50  100
    15   | 14 (0x0E) |  0x4E        | Orange         | 100   50    0
    16   |  7 (0x07) |  0x47        | Pink           | 100   50   50
    17   | 15 (0x0F) |  0x4F        | Pastel Magenta | 100   50  100
    18   | 18 (0x12) |  0x52        | Bright Green   |   0  100    0
    19   |  2 (0x02) |  0x42 (0x51) | Sea Green      |   0  100   50
    20   | 19 (0x13) |  0x53        | Bright Cyan    |   0  100  100
    21   | 26 (0x1A) |  0x5A        | Lime           |  50  100    0
    22   | 25 (0x19) |  0x59        | Pastel Green   |  50  100   50
    23   | 27 (0x1B) |  0x5B        | Pastel Cyan    |  50  100  100
    24   | 10 (0x0A) |  0x4A        | Bright Yellow  | 100  100    0
    25   |  3 (0x03) |  0x43 (0x49) | Pastel Yellow  | 100  100   50
    26   | 11 (0x0B) |  0x4B        | Bright White   | 100  100  100
---------------------------------------------------------------------------
   Table 1. Colour values on the CPC (Firmware, Hardware and RGB)</pre></blockquote><p>Table 1 shows Firmware colour values (column 1), Hardware correspondant colour values (column 2) and classic Hardware values (column 3) which include the colour value (5 Least significant bits) along with the command for the Gate Array (3 Most significant bits).&nbsp; As this function already provides hardware commands, the values it requires are the ones from column 2 (Hardware).&nbsp; Table 1 also provides colour names and precentages of RGB values for better understanding.</p><h4 class=CHeading>Known limitations</h4><p>This function cannot set blinking colors, as blinking colours are managed by the firmware (not by hardware).</p><h4 class=CHeading>Destroyed Register values</h4><p>AF, BC, DE, HL</p><h4 class=CHeading>Required memory</h4><p>35 bytes</p><h4 class=CHeading>Time Measures</h4><blockquote><pre class="prettyprint">   Case    | Cycles      | microSecs (us)
---------------------------------------------
    Any    | 101 + 78*NC | 25,25 + 19,50*NC
---------------------------------------------
Asm saving |    -54      |    -13.50
---------------------------------------------</pre></blockquote><p>NC=Number of colours to be set</p><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>Example</td><td class=CDLDescription>On setting NC=16 colours: 1349 cycles (337.25 us)</td></tr></table><h4 class=CHeading>Credits</h4><p>This function has been constructed with great help from the documentation at Grimware about the Gate Array.</p><p><a href="http://www.grimware.org/doku.php/documentations/devices/gatearray" class=LURL target=_top>http://www.grimware.org<wbr>/doku.php<wbr>/documentations<wbr>/devices<wbr>/gatearray</a></p></div></div></div>

</div><!--Content-->


<div id=Footer>&copy;opyright 2015 CPCtelera authors. Distributed under GNU GPL License.&nbsp; &middot;&nbsp; Last updated 2015/05/07&nbsp; &middot;&nbsp; <a href="http://www.naturaldocs.org">Generated by Natural Docs</a></div><!--Footer-->


<div id=Menu><div class=MTitle>CPCtelera<div class=MSubTitle>Reference Manual &amp; Documentation</div></div><div class=MEntry><div class=MLink><a href="https://github.com/lronaldo/cpctelera">CPCtelera at Github</a></div></div><div class=MEntry><div class=MText>______________________________________________________________________</div></div><div class=MEntry><div class=MFile><a href="../types-h.html">Aliases for builtin types</a></div></div><div class=MEntry><div class=MText>______________________________________________________________________</div></div><div class=MEntry><div class=MText>Packages</div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent1')">Audio</a><div class=MGroupContent id=MGroupContent1><div class=MEntry><div class=MFile><a href="../audio/arkostracker-s.html">Arkos Player Functions</a></div></div><div class=MEntry><div class=MFile><a href="../audio/arkosplayer-txt.html">Arkos Player Manual</a></div></div><div class=MEntry><div class=MFile><a href="../audio/audio-h.html">Audio Constants&amp;Variables</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_musicPlay">cpct_akp_musicPlay</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_musicInit">cpct_akp_musicInit</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_stop">cpct_akp_stop</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_SFXGetInstrument">cpct_akp_SFXGetInstrument</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_SFXInit">cpct_akp_SFXInit</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_SFXStopAll">cpct_akp_SFXStopAll</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_SFXPlay">cpct_akp_SFXPlay</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_stop">cpct_akp_SFXStop</a></div></div><div class=MEntry><div class=MLink><a href="/cpctelera/files/audio/arkostracker-s.html&#x23;cpct_akp_setFadeVolume">cpct_akp_setFadeVolume</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent2')">Bitarray</a><div class=MGroupContent id=MGroupContent2><div class=MEntry><div class=MFile><a href="../bitarray/cpct_get2Bits-s.html">cpct_get2Bits</a></div></div><div class=MEntry><div class=MFile><a href="../bitarray/cpct_get4Bits-s.html">cpct_get4Bits</a></div></div><div class=MEntry><div class=MFile><a href="../bitarray/cpct_getBit-s.html">cpct_getBit</a></div></div><div class=MEntry><div class=MFile><a href="../bitarray/cpct_set2Bits-s.html">cpct_set2Bits</a></div></div><div class=MEntry><div class=MFile><a href="../bitarray/cpct_set4Bits-s.html">cpct_set4Bits</a></div></div><div class=MEntry><div class=MFile><a href="../bitarray/cpct_setBit-s.html">cpct_setBit</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent3')">Firmware</a><div class=MGroupContent id=MGroupContent3><div class=MEntry><div class=MFile><a href="../firmware/cpct_disableFirmware-s.html">cpct_disableFirmware</a></div></div><div class=MEntry><div class=MFile><a href="../firmware/cpct_reenableFirmware-s.html">cpct_reenableFirmware</a></div></div><div class=MEntry><div class=MFile><a href="../firmware/cpct_enableDisableROMs-s.html">Enabling / disabling ROMs</a></div></div><div class=MEntry><div class=MFile><a href="../firmware/firmware-s.html">Firmware&amp;ROM variables</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent4')">Keyboard</a><div class=MGroupContent id=MGroupContent4><div class=MEntry><div class=MFile><a href="../keyboard/cpct_isKeyPressed-s.html">cpct_isKeyPressed</a></div></div><div class=MEntry><div class=MFile><a href="../keyboard/cpct_isKeyPressed_asm-s.html">cpct_isKeyPressed_asm</a></div></div><div class=MEntry><div class=MFile><a href="../keyboard/cpct_scanKeyboard-s.html">cpct_scanKeyboard</a></div></div><div class=MEntry><div class=MFile><a href="../keyboard/cpct_scanKeyboard_f-s.html">cpct_scanKeyboard_f</a></div></div><div class=MEntry><div class=MFile><a href="../keyboard/keyboard-h.html">Keyboard Mappings&amp;Constants</a></div></div><div class=MEntry><div class=MFile><a href="../keyboard/keyboard-txt.html">Keyboard Technicals</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent5')">Sprites</a><div class=MGroupContent id=MGroupContent5><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawSolidBox-s.html">cpct_drawSolidBox</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawSprite-s.html">cpct_drawSprite</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawSpriteMasked-s.html">cpct_drawSpriteMasked</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawTileAligned2x8-s.html">cpct_drawTileAligned2x8</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawTileAligned2x8_f-s.html">cpct_drawTileAligned2x8_f</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawTileAligned4x8-s.html">cpct_drawTileAligned4x8</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_drawTileAligned4x8_f-s.html">cpct_drawTileAligned4x8_f</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_px2byteM0-s.html">cpct_px2byteM0</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/cpct_px2byteM1-s.html">cpct_px2byteM1</a></div></div><div class=MEntry><div class=MFile><a href="../sprites/sprites-h.html">Sprite Macros&amp;Constants</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent6')">Strings</a><div class=MGroupContent id=MGroupContent6><div class=MEntry><div class=MFile><a href="../strings/cpct_drawCharM0-s.html">cpct_drawCharM0</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawCharM1-s.html">cpct_drawCharM1</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawCharM1_f-s.html">cpct_drawCharM1_f</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawCharM2-s.html">cpct_drawCharM2</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawStringM0-s.html">cpct_drawStringM0</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawStringM1-s.html">cpct_drawStringM1</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawStringM1_f-s.html">cpct_drawStringM1_f</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_drawStringM2-s.html">cpct_drawStringM2</a></div></div><div class=MEntry><div class=MFile><a href="../strings/cpct_putChar-s.html">putchar</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent7')">Video</a><div class=MGroupContent id=MGroupContent7><div class=MEntry><div class=MFile><a href="cpct_count2VSYNC-s.html">cpct_count2VSYNC</a></div></div><div class=MEntry><div class=MFile><a href="cpct_firmware2hw_colour_table-s.html">cpct_firmware2hw_colour</a></div></div><div class=MEntry><div class=MFile><a href="cpct_fw2hw-s.html">cpct_fw2hw</a></div></div><div class=MEntry><div class=MFile><a href="cpct_getHWColor-s.html">cpct_getHWColour</a></div></div><div class=MEntry><div class=MFile><a href="cpct_setPALColour-s.html">cpct_setPALColour</a></div></div><div class=MEntry><div class=MFile id=MSelected>cpct_setPalette</div></div><div class=MEntry><div class=MFile><a href="cpct_setVideoMemoryOffset-s.html">cpct_setVideoMemoryOffset</a></div></div><div class=MEntry><div class=MFile><a href="cpct_setVideoMemoryPage-s.html">cpct_setVideoMemoryPage</a></div></div><div class=MEntry><div class=MFile><a href="cpct_setVideoMode-s.html">cpct_setVideoMode</a></div></div><div class=MEntry><div class=MFile><a href="cpct_waitVSYNC-s.html">cpct_waitVSYNC</a></div></div><div class=MEntry><div class=MFile><a href="videomode-h.html">Video Macros&amp;Constants</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent8')">Memutils</a><div class=MGroupContent id=MGroupContent8><div class=MEntry><div class=MFile><a href="../memutils/cpct_memcpy-s.html">cpct_memcpy</a></div></div><div class=MEntry><div class=MFile><a href="../memutils/cpct_memset-s.html">cpct_memset</a></div></div></div></div></div><div class=MEntry><div class=MGroup><a href="javascript:ToggleMenu('MGroupContent9')">Index</a><div class=MGroupContent id=MGroupContent9><div class=MEntry><div class=MIndex><a href="../../index/Constants.html">Constants</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/General.html">Everything</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/Files.html">Files</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/Functions.html">Functions</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/Macros.html">Macros</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/Types.html">Types</a></div></div><div class=MEntry><div class=MIndex><a href="../../index/Variables.html">Variables</a></div></div></div></div></div><script type="text/javascript"><!--
var searchPanel = new SearchPanel("searchPanel", "HTML", "../../search");
--></script><div id=MSearchPanel class=MSearchPanelInactive><input type=text id=MSearchField value=Search onFocus="searchPanel.OnSearchFieldFocus(true)" onBlur="searchPanel.OnSearchFieldFocus(false)" onKeyUp="searchPanel.OnSearchFieldChange()"><select id=MSearchType onFocus="searchPanel.OnSearchTypeFocus(true)" onBlur="searchPanel.OnSearchTypeFocus(false)" onChange="searchPanel.OnSearchTypeChange()"><option  id=MSearchEverything selected value="General">Everything</option><option value="Constants">Constants</option><option value="Files">Files</option><option value="Functions">Functions</option><option value="Macros">Macros</option><option value="Types">Types</option><option value="Variables">Variables</option></select></div><script language=JavaScript><!--
HideAllBut([7], 10);// --></script></div><!--Menu-->



<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CFunction>Changes the hardware palette colour values (selecting new ones).</div></div><div class=CToolTip id="tt2"><div class=CType>unsigned char      (u8  = unsigned  8-bits, 1 byte )</div></div><!--END_ND_TOOLTIPS-->




<div id=MSearchResultsWindow><iframe src="" frameborder=0 name=MSearchResults id=MSearchResults></iframe><a href="javascript:searchPanel.CloseResultsWindow()" id=MSearchResultsWindowClose>Close</a></div>


<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>